---
import clsx from "clsx";
import InfrastructureCanvas from "./InfrastructureCanvas.astro";
import Steps from "./Steps.astro";
const items = [
	{
		id: "hiw-1",
		name: "Create & Choose your Cloud Provider",
		description:
            "Get started by creating a new project with your desired cloud provider.",
	},
	{
		id: "hiw-2",
		name: "Connect and Sync your Accounts with 1-Click",
		description:
		"Securely connect your AWS account to monitor and manage your resources " +
            "where you have full ownership and control.",
	},
	{
		id: "hiw-3",
		name: "Manage & Monitor your Infrastructure",
		description:
            "Voila! Visualize and monitor your cloud infrastructure in an instant! " +
            "Debug and identify point of failures to quickly fix them.",
	},
];
---

<div class="w-full" data-carousel="static">
	<div class="">
		{
			items.map((item, i) => {
				return (
					<section
						id={item.id}
						class={clsx(
							i === 0 ? "mt-10" : "mt-28",
						)}
					>
						<div class={clsx("grid grid-cols-2 gap-4 h-full")}>
							{i === 1 && (
								<div class="col-span-2 md:col-span-1 hidden md:block">
									<Steps index={i} />
								</div>
							)}
							<div
								class={clsx(
									"px-5 col-span-2 md:col-span-1 flex flex-col",
									i !== 1 ? "md:items-end md:text-end" : "",
									i === 2 ? "lg:justify-start md:justify-center lg:mt-24" : "md:justify-center"
								)}
							>
								<div class="font-extrabold text-3xl">
                                    0{i + 1}
								</div>
								<h3 class="font-bold text-2xl mt-5">
									{item.name}
								</h3>
								<p class="mt-5">{item.description}</p>
							</div>
							{i !== 2 && (
								<div
									class={clsx(
										"col-span-2 md:col-span-1",
										i === 1 ? "md:hidden block" : ""
									)}
								>
									<Steps index={i} />
								</div>
							)}
							{i === 2 && (
								<div
									class={clsx(
										"col-span-2 md:col-span-1",
									)}
								>
									<div>
										<div class="border-gray-100 border-2 shadow-lg p-3 rounded-md w-[90%]">
											<img
												src="/assets/images/diagnose.webp"
												alt="debug-cloud"
												class=""
												width="100%"
												height="100%"
											/>
										</div>
									</div>
									<div class="flex justify-end">
										<div
											class={clsx(
												"shadow-lg rounded-md p-3",
												"border-gray-100 border-2 z-20 bg-white",
												"relative -mt-10 w-[80%]"
											)}
										>
											<img
												src="/assets/images/cloud-monitor.webp"
												alt="monitor-cloud-2"
												class=""
												width="100%"
												height="100%"
											/>
										</div>
									</div>
								</div>
							)}
						</div>
					</section>
				);
			})
		}
	</div>
    <!-- <button
		type="button"
		class={clsx(
			"absolute top-[50%] start-0 z-30",
			"px-4 cursor-pointer group focus:outline-none",
		)}
		id="previous"
	>
		<span
			class={clsx(
				"inline-flex items-center justify-center w-10 h-10",
				"rounded-full bg-white/30 dark:bg-gray-200/30 group-hover:bg-white/50",
				"dark:group-hover:bg-gray-200/60 group-focus:ring-4 group-focus:ring-white",
				"dark:group-focus:ring-gray-200/70 group-focus:outline-none",
			)}
		>
			<svg
				class="w-4 h-4 text-white dark:text-gray-800 rtl:rotate-180"
				aria-hidden="true"
				xmlns="http://www.w3.org/2000/svg"
				fill="none"
				viewBox="0 0 6 10"
			>
				<path
					stroke="currentColor"
					stroke-line-cap="round"
					stroke-line-join="round"
					stroke-width="2"
					d="M5 1 1 5l4 4"></path>
			</svg>
			<span class="sr-only">Previous</span>
		</span>
	</button>
	<button
		type="button"
		class={clsx(
			"absolute top-[50%] end-0 z-30 px-4 cursor-pointer group focus:outline-none",
		)}
		id="next"
	>
		<span
			class={clsx(
				"inline-flex items-center justify-center w-10 h-10",
				"rounded-full bg-white/30 dark:bg-gray-200/30 group-hover:bg-white/50",
				"dark:group-hover:bg-gray-200/60 group-focus:ring-4 group-focus:ring-white",
				"dark:group-focus:ring-gray-200/70 group-focus:outline-none",
			)}
		>
			<svg
				class="w-4 h-4 text-white dark:text-gray-800 rtl:rotate-180"
				aria-hidden="true"
				xmlns="http://www.w3.org/2000/svg"
				fill="none"
				viewBox="0 0 6 10"
			>
				<path
					stroke="currentColor"
					stroke-line-cap="round"
					stroke-line-join="round"
					stroke-width="2"
					d="m1 9 4-4-4-4"></path>
			</svg>
			<span class="sr-only">Next</span>
		</span>
	</button> -->
</div>

<!-- <script>
    type CarouselItem = {
        el: Element;
        position: number;
    };
    type RotationItems = {
        left: CarouselItem;
        middle: CarouselItem;
        right: CarouselItem;
    };

    let currentPosition = 0;
    const slides = document.querySelectorAll("[data-carousel-item]");
    const carouselItems: CarouselItem[] = [];
    slides.forEach((el, i) => {
    	carouselItems.push({
    		position: i,
    		el,
    	});
    });

    const rotateSlides = (
    	rotationItems: RotationItems,
    	direction?: "left" | "right",
    ) => {
    	carouselItems.map((item) => {
    		item.el.classList.add("hidden");
    	});
    	// left item (previously active)
    	rotationItems.left.el.classList.remove(
    		"-translate-x-full",
    		"translate-x-full",
    		"translate-x-0",
    		"z-20",
    	);
    	if (!direction) {
    		rotationItems.left.el.classList.remove("hidden");
    		rotationItems.right.el.classList.remove("hidden");
    	}
    	if (direction === "right") {
    		rotationItems.left.el.classList.remove("hidden");
    	}
    	rotationItems.left.el.classList.add("-translate-x-full", "z-10");

    	// currently active item
    	rotationItems.middle.el.classList.remove(
    		"-translate-x-full",
    		"translate-x-full",
    		"translate-x-0",
    		"hidden",
    		"z-10",
    	);
    	rotationItems.middle.el.classList.add("translate-x-0", "z-20");

    	rotationItems.middle.el.addEventListener("transitionend", () => {
    		if (direction === "right") {
    			rotationItems.right.el.classList.remove("hidden");
    		} else if (direction === "left") {
    			rotationItems.left.el.classList.remove("hidden");
    		}
    	});

    	// right item (upcoming active)
    	rotationItems.right.el.classList.remove(
    		"-translate-x-full",
    		"translate-x-full",
    		"translate-x-0",
    		"z-20",
    	);
    	if (direction === "left") {
    		rotationItems.right.el.classList.remove("hidden");
    	}
    	rotationItems.right.el.classList.add("translate-x-full", "z-10");
    };

    const slideTo = (position: number, direction?: "left" | "right") => {
    	const nextItem = carouselItems[position];
    	const rotationItems: RotationItems = {
    		left:
                nextItem.position === 0
                	? carouselItems[carouselItems.length - 1]
                	: carouselItems[nextItem.position - 1],
    		middle: nextItem,
    		right:
                nextItem.position === carouselItems.length - 1
                	? carouselItems[0]
                	: carouselItems[nextItem.position + 1],
    	};
    	rotateSlides(rotationItems, direction);
    };

    slideTo(currentPosition);

    const prevBtn = document.getElementById("previous");
    prevBtn?.addEventListener("click", () => {
    	currentPosition = currentPosition - 1;
    	if (currentPosition < 0) currentPosition = carouselItems.length - 1;
    	slideTo(currentPosition, "left");
    });

    const next = () => {
    	console.log("clicked...");
    	currentPosition = currentPosition + 1;
    	if (currentPosition === carouselItems.length) currentPosition = 0;
    	slideTo(currentPosition, "right");
    };
    const nextBtn = document.getElementById("next");
    nextBtn?.addEventListener("click", next);

    [ 0, 1 ].map((idx) => {
    	const stepsNextBtn = document.getElementById("submit-next-" + idx);
    	stepsNextBtn?.addEventListener("click", next);
    });
</script> -->
